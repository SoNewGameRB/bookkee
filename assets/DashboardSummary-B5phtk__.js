import{r as i,h as d,o as F,c as s,b as t,a as v,j as B,v as H,k as E,x as J,i as c,t as u,n as M,F as V,d as w,g as a}from"./index-Dir_52Wl.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"summary-container"},T={class:"top-section"},W={class:"filter-box"},z={class:"budget-box"},L={key:0,class:"alert-box"},P={key:0,class:"warning"},R={key:1,class:"warning"},$={key:2,class:"critical-warning"},q={class:"summary-box"},A={key:0,class:"warning"},G={key:1,class:"suggest-box"},K={class:"history-box"},Q={key:0},X={key:1},Y={__name:"DashboardSummary",setup(Z){const f=i([]),r=i(new Date().toISOString().slice(0,7)),b=i("70"),S=i(0),n=i(0),x=i([]),I=i({}),h=d(()=>x.value.filter(l=>l.month===r.value)),y=d(()=>f.value.filter(l=>l.category==="income"&&l.date.startsWith(r.value)).reduce((l,e)=>l+e.amount,0)),p=d(()=>f.value.filter(l=>l.category==="expense"&&l.date.startsWith(r.value)).reduce((l,e)=>l+e.amount,0)),k=d(()=>y.value-p.value),g=d(()=>n.value>0?(p.value/n.value*100).toFixed(0):0),N=d(()=>p.value>n.value),D=d(()=>N.value?Object.entries(I.value).sort((l,e)=>e[1]-l[1]).map(([l])=>l).slice(0,2):[]),C=()=>{b.value==="custom"?n.value=S.value:n.value=(y.value*(parseInt(b.value)/100)).toFixed(0);const l=localStorage.getItem("budgetHistory");let e=l?JSON.parse(l):[];const o=e.findIndex(O=>O.month===r.value),m={month:r.value,income:y.value,expense:p.value,budget:n.value,overBudget:p.value>n.value};o!==-1?e[o]=m:e.push(m),localStorage.setItem("budgetHistory",JSON.stringify(e)),x.value=e};return F(()=>{const l=localStorage.getItem("records");l&&(f.value=JSON.parse(l));const e=localStorage.getItem("budgetHistory");e&&(x.value=JSON.parse(e));const o=localStorage.getItem(`budget_${r.value}`);o?n.value=parseFloat(o):n.value=0,C()}),(l,e)=>(a(),s("div",j,[e[18]||(e[18]=t("h2",null,"📈 月結餘 & 預算管理",-1)),t("div",T,[t("div",W,[e[5]||(e[5]=t("label",null,"📅 選擇月份：",-1)),B(t("input",{type:"month","onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),onChange:e[1]||(e[1]=(...o)=>l.updateSummary&&l.updateSummary(...o))},null,544),[[H,r.value]])]),t("div",z,[e[8]||(e[8]=t("h3",null,"🎯 預算設定",-1)),e[9]||(e[9]=t("label",null,"選擇預算比例：",-1)),B(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>b.value=o),onChange:C},e[6]||(e[6]=[J('<option value="50" data-v-b4c9452a>50%（節約模式）</option><option value="60" data-v-b4c9452a>60%</option><option value="70" data-v-b4c9452a>70%</option><option value="80" data-v-b4c9452a>80%</option><option value="90" data-v-b4c9452a>90%（寬鬆模式）</option><option value="custom" data-v-b4c9452a>自訂</option>',6)]),544),[[E,b.value]]),b.value==="custom"?B((a(),s("input",{key:0,type:"number","onUpdate:modelValue":e[3]||(e[3]=o=>S.value=o),placeholder:"輸入預算",onInput:e[4]||(e[4]=(...o)=>l.saveCustomBudget&&l.saveCustomBudget(...o))},null,544)),[[H,S.value]]):v("",!0),t("p",null,[e[7]||(e[7]=t("strong",null,"當月預算：",-1)),c(" "+u(n.value)+" 元",1)])])]),g.value>=80?(a(),s("div",L,[g.value>=80&&g.value<90?(a(),s("p",P,"⚠️ 你已花掉 80% 預算，請注意支出")):v("",!0),g.value>=90&&g.value<100?(a(),s("p",R,"⚠️ 你已花掉 90% 預算，請謹慎管理")):v("",!0),g.value>=100?(a(),s("p",$,"🚨 你已超出預算，請控制開銷！")):v("",!0)])):v("",!0),t("div",q,[e[13]||(e[13]=t("h3",null,"📊 當月結餘",-1)),t("p",null,[e[10]||(e[10]=t("strong",null,"總收入：",-1)),c(" "+u(y.value)+" 元",1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"總支出：",-1)),c(" "+u(p.value)+" 元",1)]),t("p",{class:M(k.value<0?"negative":"positive")},[e[12]||(e[12]=t("strong",null,"結餘：",-1)),c(" "+u(k.value)+" 元 ",1)],2),k.value<0?(a(),s("p",A,"⚠️ 你的支出超過收入！")):v("",!0)]),N.value?(a(),s("div",G,[e[14]||(e[14]=t("h3",null,"⚠️ 減少支出建議",-1)),e[15]||(e[15]=t("p",null,"你的支出已超過預算，建議減少以下類別開銷：",-1)),t("ul",null,[(a(!0),s(V,null,w(D.value,(o,m)=>(a(),s("li",{key:m}," 📌 "+u(o)+"（"+u(I.value[o])+" 元） ",1))),128))])])):v("",!0),t("div",K,[e[17]||(e[17]=t("h3",null,"📜 預算歷史",-1)),h.value.length===0?(a(),s("p",Q,"當月沒有預算記錄")):(a(),s("table",X,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",null,"月份"),t("th",null,"收入"),t("th",null,"支出"),t("th",null,"預算"),t("th",null,"超支")])],-1)),t("tbody",null,[(a(!0),s(V,null,w(h.value,(o,m)=>(a(),s("tr",{key:m},[t("td",null,u(o.month),1),t("td",null,u(o.income)+" 元",1),t("td",null,u(o.expense)+" 元",1),t("td",null,u(o.budget)+" 元",1),t("td",null,u(o.overBudget?"✔":"❌"),1)]))),128))])]))])]))}},te=U(Y,[["__scopeId","data-v-b4c9452a"]]);export{te as default};
